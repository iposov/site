# События

Программирование интерфейса - это написание кода,
который срабатывает при возникновении различных событий:
1. Нажата кнопка
1. Изменен текст в поле ввода текста
1. Изменен размер окна
1. Окно развернуто на весь экран
1. Изменено значение в слайдере (компонент, где
можно двигать ползунок)
1. Выбран новый элемент списка или выпадающего списка.

События более низкого уровня
1. События клавиатуры
    1. Кнопка нажата
    1. Кнопка отпущена
    1. Кнопка сработала (нажали, потом буква повторяется)
1. События мыши
    1. Кнопку нажата
    1. Кнопка отпущена
    1. Двойной щелчок
    1. Мышь подвинулась
    1. Мышь наведена на какой-то компонент (кнопку)
    1. Мышь увели с компонента

Событие, например, "нажата кнопка" (button) может
произойти как результат события "нажата кнопка мыши",
когда мышь была поверх button. Либо как результат
нажатия на пробел на клавиатуре, когда кнопка была
выделена.

Понятия
 * Событие - объект с информаций о некотором событии,
например, если это событие мыши, то в информации будут
координаты мыши, какие кнопки мыши нажаты. Если это
событие клавиатуры, то какая кнопка клавиатуры нажата или
отпущена, какие при этом нажаты модификаторы (ctrl, shift).
Если изменилось какое-то значение, допустим,
ширина окна, то информация содержит старое и новое значение.
 * Источник события. У каждого события есть источники,
 например, при нажатии на кнопку, кнопка - источник события.
 При клике по компоненту, этот компонент источник 
 события "клик мыши".
 
     *Всегда* в информации о событии известно, кто был источником
события (target). Т.е. если нажали на кнопку, будет
известно, какую именно кнопку нажали.

 * Слушатель (listener) или обработчик (handler) - 
 это объект, заинтересованный в реагировании на событие.
 Можно обратиться к источнику событий и попросить его
 зарегистрировать слушателя. Теперь каждый раз при
 возникновении события слушатель будет об этом узнавать.
 
 
Примерный код регистрации слушателя:

```
источник.addListener(Какое событие, Слушатель)
источник.addListenerТакоготоСобытия(Слушатель)
```

Конкретно для кнопки. Кнопка является источником разных
событий, в частности, как и другие компоненты она умеет
реагировать на нажатие мыши, на наведение мыши.
Нажатие кнопки - это событие ActionEvent. Чтобы его
обработать:

```
EventHandler<ActionEvent> listener = ae -> {
    //ae - тот самый объект события, т.е. с информацией
    //о событии
    sout("Меня нажали");
};
myButton.addEventHandler(ActionEvent.ACTION, listener)
//                           тип события


// Короче можно так:
myButton.addEventHandler(ActionEvent.ACTION, ae -> {
    sout("Меня нажали");
});

//а как реагировать на мышь
myButton.addEventHandler(MouseEvent.MOUSE_ENTERED, me -> {
    sout("На кнопку наведена мышь");
    //me - это объект класса MouseEvent, в нем есть
    //me.getX(), me.isAltDown() и т.п. 
});

myButton.addEventHandler(MouseEvent.MOUSE_EXITED, me -> {
    sout("Мышь уведена с кнопки мышь");
    //me - опять объект класса MouseEvent
});
```

## Свойства

В JavaFX у многих объектов есть "свойства". Это какие-то значения,
влияющие на работу объекта, и за этими значениями можно следить,
т.е. можно устанавливать слушателей, которые следят за
измененениями значений. Примеры свойств:

* У почти всех элементов интерфейса и у самого окна есть свойства
высота и ширина (width, height)
* У многих элементов интерфейса есть свойство font (шрифт)
* disable - элемент недоступен для взаимодействия (серая кнопка)
* У TextField есть свойство text - это введенный в нее текст
* В списке элементов (ListView) есть свойство "номер выделенного
элемента"

Как пользоваться свойствами:
```
объект.имяСвойстваProperty() // это свойство
объект.имяСвойстваProperty().getValue() // узнать значение
объект.имяСвойстваProperty().setValue() // иногда можно установить
объект.getИмяСвойства()  // эквивалентно предыдущему,
объект.setИмяСвойства()  // но короче
```

Например
```
//свойство text для TextField
myTextField.setText("---")
myTextField.textProperty().setValue("---")
sout(myTextField.getText());
sout(myTextField.textProperty().getValue());
```

Как следить за изменением свойств. Добавлением на них слушателей!

1 способ, можно узнать только то, что свойство изменилось:

```
myTextField.textProperty().addListener(o -> {
    //o - это то свойство, которое изменилось. Обычно не интересно
    sout("Текст изменился")
});
```

2 способ, можно узнать старое и новое значение.
```
myTextField.textProperty().addListener((o, oldVal, newVal) -> {
    sout("Текст изменился, было " + oldVal + "стало " + newVal);
});
```

см. код про метки

Еще раз про слушателей и bindings. Их не надо путать.
Слушатели универсальны, с ними можно реализовать любую
интерактивность. Иногда бывает, что удобно воспользоваться
связыванием свойств. Но
 - связывания реализованы через слушателей, поэтому без связываний
 всегда можно обойтись. Хотя связывания могут быть очень удобны.
 - Не путайте связывания и слушателей, всегда осознанно выбирайте,
 что из них использовать.
